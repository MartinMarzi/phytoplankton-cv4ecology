import cv2
import os

# testing
output_folder = "/Users/mmarzi/MLprojects/cv4e/dataset/data_bbox/interim"
yolo_annotations_dir =  "/Users/mmarzi/MLprojects/cv4e/dataset/data_bbox/interim/bbox1"
image_dir = "/Users/mmarzi/MLprojects/cv4e/dataset/data_bbox/interim/bbox1"
image_name = "Pn_calliantha_20230523_0DB2_1"

def display_yolo_bboxes(image_dir, yolo_annotations_dir, image_name):
    # Load the image
    image_path = os.path.join(image_dir, image_name + ".jpg")
    image = cv2.imread(image_path)
    img_height, img_width = image.shape[:2]
    
    # Read YOLO annotations for the image
    annotation_path = os.path.join(yolo_annotations_dir, image_name + ".txt")
    with open(annotation_path, 'r') as file:
        lines = file.readlines()
        for line in lines:
            class_id, x_center, y_center, width, height = map(float, line.strip().split())
            
            # Convert YOLO bbox coordinates to absolute pixel values
            x_center, y_center, width, height = x_center * img_width, y_center * img_height, width * img_width, height * img_height
            x1, y1, x2, y2 = int(x_center - width/2), int(y_center - height/2), int(x_center + width/2), int(y_center + height/2)
            
            # Draw bbox on the image
            cv2.rectangle(image, (x1, y1), (x2, y2), (0, 255, 0), 2)
            cv2.putText(image, str(int(class_id)), (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 2)
    
    # Display the image
    cv2.imshow('Bboxes', image)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

# Example usage
image_directory = 'path_to_images'
yolo_annotation_directory = 'path_to_yolo_annotations'
sample_image_name = 'sample_image'  # Without the file extension
display_yolo_bboxes(image_directory, yolo_annotation_directory, sample_image_name)
